<div class="full-page">
  <div [ngClass]="{'d-none': !loading}">
    <hm-loader></hm-loader>
  </div>
<table mdbTable id="incident-list" *ngIf="incidents?.length; else noIncidents">
  <tbody>
    <!-- Incident Item -->
    <tr mdbTableCol class="incident-item" *ngFor="let incident of incidents">
      <td scope="row">
          <div class="incident-description">
            <div class="action-buttons float-right">
                <a id="update-{{incident.id}}" routerLink="/incidents/update/{{incident.id}}" 
                routerLinkActive="active" *ngIf="incident.state_name !== 'Completed'; else Open">Update</a>
                <ng-template #Open>
                    <a id="update-{{incident.id}}" routerLink="/dashboard/incidents/update/{{incident.id}}" routerLinkActive="active">View</a>
                </ng-template>
            </div>
            <strong>
                <a class="incident-view-link" routerLink="/dashboard/incidents/update/{{incident.id}}" routerLinkActive="active">
                  <span *ngIf="incident?.incident_updates.length; else noUpdates">
                      <span *ngFor="let update of incident.incident_updates; let i=index">
                        <span *ngIf="update.state_name && i<1" class="incident-status" color="info">[{{ update.state_name }}] {{ incident.name }}</span>
                      </span> 
                  </span>               
                  <ng-template #noUpdates>
                    <span class="incident-status" color="info">
                        [{{ incident.state_name }}] {{ incident.name }}
                    </span>
                  </ng-template>
                </a>
            </strong><br>
            <div class="last-updated">
                <small>Beginning <span>({{ incident.scheduled_for | date:'MM/dd/yyyy   hh:mm:ss a'}})</span>
                </small>
            </div>
          </div>
      </td>      
    </tr>
  </tbody>
</table>

<!-- Zero Scheduled Incidents For the dashboard -->
<ng-template #noIncidents>
    <hm-empty-data [ngClass]="{'d-none': loading}" header="No Scheduled Maintenances" description="You will see all scheduled maintenances here">
      <a action-button routerLink='/dashboard/incidents/new/maintenance' routerlinkactive="active"> 
        <button id="create-button" size="sm" color="primary">
          New maintenance 
        </button>
      </a>
    </hm-empty-data>
</ng-template>

</div>
